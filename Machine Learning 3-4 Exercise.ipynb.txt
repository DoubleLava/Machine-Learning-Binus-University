{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "ee56d449-6fcd-4f1f-ae06-96af3ca2046f",
   "metadata": {},
   "source": [
    "# Session 3-4 Exploratory Data Analysis and Preprocessing Data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "40e5ceeb-8206-4000-8be8-a2c06df1415e",
   "metadata": {},
   "source": [
    "# Exercise"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2975fa0-d426-47e8-bf49-cf861f76a40d",
   "metadata": {},
   "source": [
    "You are a data scientist tasked with analyzing the Titanic dataset.\n",
    "\n",
    "Your ultimate goal is to build a model that predicts passenger survival during the Titanic disaster.\n",
    "\n",
    "Dataset link:ðŸ”— https://www.kaggle.com/competitions/titanic\n",
    "\n",
    "To achieve this objective, you must complete two key stages:\n",
    "\n",
    "1. Exploratory Data Analysis (EDA)\n",
    "  \n",
    "2. Data Preprocessing\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eefc47bc-4bd7-4c3b-95c2-dd399c09a7c8",
   "metadata": {},
   "source": [
    "## Step 0. Load libraries & dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2579a6f-d5f8-40a8-bae9-03ee9dfdf637",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a4b2ae4-756c-4c17-a642-4ecb27159f58",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load Titanic dataset (after downloading from Kaggle)\n",
    "df = pd.read_csv(\"train.csv\")\n",
    "\n",
    "df.head()"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "1e0f3858-1755-4fc0-bd9f-d449050eb6fb",
   "metadata": {},
   "source": [
    "## 1. Exploratory data analysis (EDA)\n",
    "\n",
    "Perform EDA to understand the structure and characteristics of the dataset."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3b6303d0-849e-41e7-9cb3-87db11b704c9",
   "metadata": {},
   "source": [
    "### 1-1) Conduct descriptive analysis of key features such as:\n",
    "â€¢ age, sex, pclass, and other relevant variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "00b3e6ab-8f7c-47c5-ab71-4e914f5a617b",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    }
   },
   "outputs": [],
   "source": [
    "# Basic dataset information\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "602f8178-c155-4890-a88b-e38c13222a44",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Descriptive statistics for numerical features\n",
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7768a02f-1939-4685-abae-19a9c8cb43c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Value counts for categorical features\n",
    "df['Sex'].value_counts()\n",
    "df['Pclass'].value_counts()\n",
    "df['Survived'].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1b25380b-ac6f-4de9-aaad-950905a648a4",
   "metadata": {},
   "source": [
    "### 1-2) Examine data distributions and identify any noticeable patterns or trends."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eb8e90d3-c0f0-42d9-a02e-c0b024c309c4",
   "metadata": {},
   "source": [
    "#### Age distribution"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a92b89d-1322-4351-b60c-c14e08a730a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.hist(df['Age'].dropna(), bins=30)\n",
    "plt.xlabel(\"Age\")\n",
    "plt.ylabel(\"Count\")\n",
    "plt.title(\"Age Distribution\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c26838f-a576-43b9-ae0b-4850c27e1b50",
   "metadata": {},
   "source": [
    "#### Survival distribution"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "53cc24cd-2bf7-4447-a1d2-b93b26da074b",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.countplot(x='Survived', data=df)\n",
    "plt.title(\"Survival Count\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e47c5797-8992-4e6d-9fd4-8caad08bfc49",
   "metadata": {},
   "source": [
    "### 1-3) Use visualizations to explore relationships between variables, including:\n",
    "â€¢ Histograms\n",
    "â€¢ Box plots\n",
    "â€¢ Scatter plots"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa11fea7-b27c-4189-aba2-50d44410a31a",
   "metadata": {},
   "source": [
    "#### Histogram: Age by survival"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c384f79e-b1ae-4e45-8f64-977c8669b43a",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.histplot(data=df, x='Age', hue='Survived', bins=30, kde=True)\n",
    "plt.title(\"Age Distribution by Survival\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86abd06b-7577-4719-9147-5850e0d04c50",
   "metadata": {},
   "source": [
    "#### Box plot: Age vs Survival"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "30e065f3-1bde-4f6a-b4d7-4982c2ad4a88",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.boxplot(x='Survived', y='Age', data=df)\n",
    "plt.title(\"Age vs Survival\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f7cc8471-5eb9-4a54-b18c-bbdc3b539f61",
   "metadata": {},
   "source": [
    "#### Scatter plot: Age vs Fare"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a7aab4f2-e7f6-4bca-9f50-2adc7676a268",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.scatterplot(x='Age', y='Fare', hue='Survived', data=df)\n",
    "plt.title(\"Age vs Fare by Survival\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "331d4101-21bf-4a78-88bb-8f5bd27d9010",
   "metadata": {},
   "source": [
    "### 1-4) Identify and explain insightful patterns that may help predict passenger survival (e.g., survival differences by gender or passenger class)."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bee1191f-79cc-4fb3-b226-75b10642f17b",
   "metadata": {},
   "source": [
    "#### Survival rate by gender"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63f4c7c2-40cc-49ad-95a9-7369853cfaea",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.barplot(x='Sex', y='Survived', data=df)\n",
    "plt.title(\"Survival Rate by Gender\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d78cb7ef-39f1-42cd-8354-3f43f57e4cf3",
   "metadata": {},
   "source": [
    "#### Survival rate by passenger class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "30e95e6b-87ef-46e2-bea6-3884e850fae7",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.barplot(x='Pclass', y='Survived', data=df)\n",
    "plt.title(\"Survival Rate by Passenger Class\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dfbd640c-923b-426b-b9cb-915cf0b87619",
   "metadata": {},
   "source": [
    "#### Key insights you can explain in words:\n",
    "\n",
    "* Females had a much higher survival rate than males\n",
    "\n",
    "* 1st class passengers survived more than 3rd class\n",
    "\n",
    "* Younger passengers had slightly higher survival chances"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b8dabed3-7c99-4b9c-aef8-e763f551234f",
   "metadata": {},
   "source": [
    "## 2. Data preprocessing\n",
    "Prepare the dataset for modeling by performing the following steps:"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "1bc052bf-8a7a-4dbc-886f-24b0c451cbcd",
   "metadata": {},
   "source": [
    "### 2-1) Handle missing values:\n",
    "\n",
    "â€¢ Decide whether to fill in missing data or remove rows/columns where\t   appropriate.\n",
    "\n",
    "â€¢ Clearly justify your chosen strategy.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "accc7d6f-b71a-4b47-9790-b952daba2b1e",
   "metadata": {},
   "source": [
    "#### Check missing values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "24dac578-690c-415d-98e0-565a05b51cf9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "532904f6-a4af-4e00-b306-baf98e40fc03",
   "metadata": {},
   "source": [
    "#### Strategy\n",
    "\n",
    "* Age â†’ fill with median (robust to outliers)\n",
    "\n",
    "* Embarked â†’ fill with most frequent value\n",
    "\n",
    "* Cabin â†’ drop (too many missing values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bb2c9ac1-1795-4b54-a728-b259ed8f354c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Fill Age with median\n",
    "df['Age'] = df['Age'].fillna(df['Age'].median())\n",
    "\n",
    "# Fill Embarked with mode\n",
    "df['Embarked'] = df['Embarked'].fillna(df['Embarked'].mode()[0])\n",
    "\n",
    "# Drop Cabin column\n",
    "df = df.drop(columns=['Cabin'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e1dde2f-f163-4227-ac8f-a82cf24ec6fc",
   "metadata": {},
   "source": [
    "### 2-2) Encode categorical variables:\n",
    "\n",
    "â€¢ Apply suitable encoding techniques (e.g., label encoding, one-hot encoding).\n",
    "\n",
    "â€¢ Explain why the chosen encoding method is appropriate."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c33a6a7e-0724-4d3f-b0d0-fb00e877ffe1",
   "metadata": {},
   "source": [
    "#### Identify categorical features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3de7cc1-5595-4414-b33b-6db855624821",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.select_dtypes(include='object').columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "76ac2aef-600c-4c36-80b9-dab9ae3a897f",
   "metadata": {},
   "source": [
    "#### One-hot encoding (best for nominal categories)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a777809-1692-417e-ba55-ded333e1ab96",
   "metadata": {},
   "outputs": [],
   "source": [
    "# pandas.get_dummies\n",
    "# Each variable is converted in as many 0/1 variables as there are different values.\n",
    "# Columns in the output are each named after a value;\n",
    "# if the input is a DataFrame, the name of the original variable is prepended to the value.\n",
    "df = pd.get_dummies(df, columns=['Sex', 'Embarked'], drop_first=True)\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "66e69788-d55f-478d-aa9a-7399f44b5fc5",
   "metadata": {},
   "source": [
    "#### Why one-hot encoding?\n",
    "\n",
    "* No ordinal relationship between categories\n",
    "\n",
    "* Prevents misleading numeric ordering"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "402e06a4-da2e-434d-83cd-470fdd1f31b4",
   "metadata": {},
   "source": [
    "### 2-3) Scale numerical features:\n",
    "\n",
    "â€¢ Normalize or standardize numerical variables where necessary.\n",
    "\n",
    "â€¢ Justify your choice of scaling method."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "75578c5f-0265-4703-9def-0b34a91287f3",
   "metadata": {},
   "source": [
    "scikit-learn is a Python library that makes machine learning easy by providing ready-to-use tools for data preprocessing, modeling, and evaluation.\n",
    "\n",
    "In simple terms:\n",
    "\n",
    "1. You give it data\n",
    "\n",
    "2. Choose a model (e.g., classification, regression, clustering)\n",
    "\n",
    "3. Call `fit()` to train\n",
    "\n",
    "4. Call `predict()` to make predictions\n",
    "\n",
    "Why people love it:\n",
    "\n",
    "* Simple and consistent API (`fit`, `predict`, `transform`)\n",
    "\n",
    "* Works well with NumPy and pandas\n",
    "\n",
    "* Includes common ML algorithms (linear regression, SVM, k-means, decision trees)\n",
    "\n",
    "* Has built-in tools for scaling, encoding, and validation"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ff9234b-0f27-48e7-90ad-d740a3b50ca9",
   "metadata": {},
   "source": [
    "#### Select numerical features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49a796c7-9fb8-469e-970d-968117e78e1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "num_features = ['Age', 'Fare']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0042aa9-c7db-44c4-a54c-479c2a687b29",
   "metadata": {},
   "source": [
    "#### Standardization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3e5fac7c-e3f5-46fa-a935-a6a1ce23e333",
   "metadata": {},
   "outputs": [],
   "source": [
    "scaler = StandardScaler()\n",
    "df[num_features] = scaler.fit_transform(df[num_features])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae5ff432-4c79-461e-aa3a-def0a67db449",
   "metadata": {},
   "source": [
    "#### Why standardization?\n",
    "\n",
    "* Centers data around mean = 0\n",
    "\n",
    "* Helps models sensitive to feature scale (e.g., Logistic Regression, SVM)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d0b93854-9537-49a7-8ba0-51a19625c6d6",
   "metadata": {},
   "source": [
    "#### Final dataset ready for modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "819dcfdb-00bf-4839-85ee-ad856444e4f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d18e09a-1699-4085-8dfd-483b2f311134",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.info()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
